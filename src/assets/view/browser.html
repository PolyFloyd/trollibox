{{ define "title" }}Browser{{ end }}

{{ define "pagename" }}browser{{ end }}

{{ define "content" }}
	<div class="browser">
		<div class="browser-views">
			<ul class="browser-categories">
				<li role="presentation" id="browser-show-search">
					<a class="glyphicon glyphicon-search" title="Search Everything" href="#"></a>
				</li>
				<li role="presentation" id="browser-show-albums">
					<a class="glyphicon glyphicon-cd" title="Browse Albums" href="#"></a>
				</li>
				<li role="presentation" id="browser-show-browse">
					<a class="glyphicon glyphicon-music" title="Browse Artists By Genre" href="#"></a>
				</li>
				<li role="presentation" id="browser-show-files">
					<a class="glyphicon glyphicon-folder-open" title="Browse Files" href="#"></a>
				</li>
				<li role="presentation" id="browser-show-streams">
					<a class="glyphicon glyphicon-globe" title="Network Streams" href="#"></a>
				</li>
			</ul>

			<div class="browser-views-content"></div>
		</div>

		<div class="browser-player hidden-xs"></div>
	</div>
{{ end }}

{{ define "init" }}
	<script>
		var player = new Player();
		player.on('error', function(err) {
			console.error(err);
		});

		var browserViews = {
			search: new BrowserSearchView({
				model: player,
			}),
			albums: new BrowserAlbumsView({
				model: player,
			}),
			browse: new BrowserBrowseView({
				model: player,
			}),
			files: new BrowserFilesView({
				model: player,
			}),
			streams: new BrowserStreamsView({
				model: player,
			}),
		};

		Object.keys(browserViews).forEach(function(name, i) {
			var view = browserViews[name];
			view.$el.addClass('hidden', i !== 0);
			var $btn = $('#browser-show-'+name);
			if (i == 0) {
				view.$el.removeClass('hidden', i !== 0);
				$btn.addClass('active');
			}
			$('.browser-views-content').append(view.$el);
			function show() {
				$('.browser-categories li').removeClass('active');
				$btn.addClass('active');
				$('.browser-view').addClass('hidden');
				view.$el.removeClass('hidden');
			}
			$btn.on('click', show);
			view.on('request-focus', show);
		});

		var playerView = new PlayerView({
			model: player,
		});
		$('.browser-player').append(playerView.$el);

		$(function() {
			Hotkeys.player(player, $(document));
			Hotkeys.browserSearch(browserViews.search, $(document));
		});
	</script>
{{ end }}
